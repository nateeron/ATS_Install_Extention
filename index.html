<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>ATS Extension Manual</title>
  <style>
    body {
      font-family: "Tahoma", sans-serif;
      line-height: 1.6;
      max-width: 1000px;
      margin: 0 auto;
      padding: 40px 20px;
      background: #363636;
      color: #ededed;
      counter-reset: step;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: rgb(255, 255, 255);
    }
    p {
      margin: 16px 0;
      text-indent: 2em; /* ย่อหน้า */
      white-space: pre-line; /* ให้ \n ในข้อความขึ้นบรรทัดใหม่ */
    }
    .block {
      position: relative;
      margin-bottom: 40px;
      background-color: #44444494;
      padding: 24px 24px 24px 56px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    .block::before {
      counter-increment: step;
      content: counter(step);
      position: absolute;
      top: 18px;
      left: 18px;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #ffffff;
      color: #222;
      font-weight: bold;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    }
    .block img {
      display: block;
      max-width: 100%;
      height: 600px;
      object-fit: cover; /* หรือ contain ถ้าไม่อยากให้ครอปภาพ */
      margin: 16px auto;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .block img:hover {
      transform: scale(1.01);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    }

    /* Fullscreen image dialog */
    .image-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    .image-modal.open {
      display: flex;
    }
    .image-modal__content {
      position: relative;
      max-width: 95vw;
      max-height: 95vh;
    }
    .image-modal__content img {
      max-width: 100%;
      max-height: 100%;
      display: block;
      border-radius: 8px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
    }
    .image-modal__close {
      position: absolute;
      top: -14px;
      right: -14px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: rgba(0, 0, 0, 0.85);
      color: #fff;
      font-size: 20px;
      line-height: 32px;
      text-align: center;
      cursor: pointer;
    }
    .image-modal__close:hover {
      background: rgba(0, 0, 0, 1);
    }
    .toolbar {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-bottom: 16px;
    }
    .btn {
      padding: 6px 14px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      background: #ffffff;
      color: #222;
    }
    .btn:hover {
      background: #f0f0f0;
    }
    .btn--toggle.btn--active {
      background: #30abb1;
      color: #222;
    }

    @media print {
      body {
        max-width: none;
        background: #ffffff;
        color: #000000;
        padding: 0;
      }
      .toolbar,
      .image-modal {
        display: none !important;
      }
      .block {
        page-break-inside: avoid;
        background-color: #ffffff;
        box-shadow: none;
      }
      .block img {
        height: auto;
        max-height: none;
      }
    }
  </style>
</head>
<body>

  <!-- head text main -->
  <h1 id="pageTitle">Manual Install Extension Chrome for ATS</h1>

  <div class="toolbar">
    <button class="btn btn--toggle " id="btnLangTh">TH</button>
    <button class="btn btn--toggle btn--active" id="btnLangEn">EN</button>
    <button class="btn" id="btnExportPdf">Export to PDF</button>
  </div>

  <!-- Cards will be rendered from JSON -->
  <div id="cardsContainer"></div>

  <!-- Fullscreen image dialog -->
  <div class="image-modal" id="imageModal">
    <div class="image-modal__content">
      <button class="image-modal__close" id="imageModalClose" aria-label="Close image">&times;</button>
      <img id="imageModalImg" src="" alt="Full size image" />
    </div>
  </div>

  <script>
    (function () {
      const modal = document.getElementById('imageModal');
      const modalImg = document.getElementById('imageModalImg');
      const closeBtn = document.getElementById('imageModalClose');
      const container = document.getElementById('cardsContainer');
      const titleEl = document.getElementById('pageTitle');
      const langBtnTh = document.getElementById('btnLangTh');
      const langBtnEn = document.getElementById('btnLangEn');
      const exportBtn = document.getElementById('btnExportPdf');

      let currentLang = 'en';
      let cardsCache = [];

      function openModal(src, alt) {
        modalImg.src = src;
        modalImg.alt = alt || '';
        modal.classList.add('open');
      }

      function closeModal() {
        modal.classList.remove('open');
        modalImg.src = '';
      }

      function createCard(card, lang) {
        const block = document.createElement('div');
        block.className = 'block';

        const p = document.createElement('p');
        if (lang === 'en') {
          p.textContent = card.textEn || '';
        } else {
          p.textContent = card.textTh || '';
        }

        const img = document.createElement('img');
        img.src = card.image;
        img.alt = card.alt || '';
        img.addEventListener('click', function () {
          openModal(img.src, img.alt);
        });

        block.appendChild(p);
        block.appendChild(img);
        return block;
      }

      function renderCards() {
        container.innerHTML = '';
        cardsCache.forEach(function (card) {
          const block = createCard(card, currentLang);
          container.appendChild(block);
        });
      }

      // Load cards from JSON and render
      fetch('cards.json')
        .then(function (response) { return response.json(); })
        .then(function (cards) {
          cardsCache = cards || [];
          renderCards();
        })
        .catch(function (error) {
          console.error('Failed to load cards.json', error);
        });

      closeBtn.addEventListener('click', function (event) {
        event.stopPropagation();
        closeModal();
      });

      function setLanguage(lang) {
        currentLang = lang;
        if (lang === 'en') {
          langBtnEn.classList.add('btn--active');
          langBtnTh.classList.remove('btn--active');
          titleEl.textContent = 'Manual Install Chrome Extension for ATS';
        } else {
          langBtnTh.classList.add('btn--active');
          langBtnEn.classList.remove('btn--active');
          titleEl.textContent = 'คู่มือการติดตั้งส่วนขยาย Chrome สำหรับ ATS';
        }
        renderCards();
      }

      langBtnTh.addEventListener('click', function () {
        setLanguage('th');
      });

      langBtnEn.addEventListener('click', function () {
        setLanguage('en');
      });

      // Export to PDF via browser print
      exportBtn.addEventListener('click', function () {
        window.print();
      });

      // Close when clicking on the dark background
      modal.addEventListener('click', function (event) {
        if (event.target === modal) {
          closeModal();
        }
      });

      // Close on ESC key
      document.addEventListener('keydown', function (event) {
        if (event.key === 'Escape') {
          closeModal();
        }
      });
    })();
  </script>

</body>
</html>